# HG changeset patch
# User Ozkan Sezer <sezeroz@gmail.com>
# Date 1539440500 -10800
#      Sat Oct 13 17:21:40 2018 +0300
# Branch SDL-1.2
# Node ID f5f1e8452f745f79711763131058668b0d9dd748
# Parent  12758bec1240d03adb85e8960a2bc7598a3c78f4
backport find_lib() fix to get the latest version of libpng, etc.

(default 2.0 branch commit: 2608ba5feac1)

diff -r 12758bec1240 -r f5f1e8452f74 configure
--- a/configure	Sat Oct 13 15:55:55 2018 +0300
+++ b/configure	Sat Oct 13 17:21:40 2018 +0300
@@ -12999,7 +12999,7 @@
         host_lib_path="/usr/$base_libdir /usr/local/$base_libdir"
     fi
     for path in $env_lib_path $gcc_bin_path $gcc_lib_path $host_lib_path; do
-        lib=`ls -- $path/$1 2>/dev/null | sort | sed 's/.*\/\(.*\)/\1/; q'`
+        lib=`ls -- $path/$1 2>/dev/null | sed -e '/\.so\..*\./d' -e 's,.*/,,' | sort | tail -1`
         if test x$lib != x; then
             echo $lib
             return
@@ -13877,12 +13877,9 @@
                 jpg_lib=`find_lib "libjpeg*.dll"`
                 ;;
             *)
-                jpg_lib=`find_lib "libjpeg.so.[0-9]"`
+                jpg_lib=`find_lib "libjpeg[0-9]*.so.*"`
                 if test x$jpg_lib = x; then
-                    jpg_lib=`find_lib "libjpeg.so.[0-9][0-9]"`
-                fi
-                if test x$jpg_lib = x; then
-                    jpg_lib=`find_lib "libjpeg.so.[0-9]*"`
+                    jpg_lib=`find_lib "libjpeg.so.*"`
                 fi
                 ;;
         esac
@@ -14396,15 +14393,9 @@
                 png_lib=`find_lib "libpng*.dll"`
                 ;;
             *)
-                png_lib=`find_lib "libpng.so.[0-9]"`
-                if test x$png_lib = x; then
-                    png_lib=`find_lib "libpng.so.[0-9]*"`
-                fi
+                png_lib=`find_lib "libpng[0-9]*.so.*"`
                 if test x$png_lib = x; then
-                    png_lib=`find_lib "libpng*.so.[0-9]"`
-                fi
-                if test x$png_lib = x; then
-                    png_lib=`find_lib "libpng*.so.[0-9]*"`
+                    png_lib=`find_lib "libpng.so.*"`
                 fi
                 ;;
         esac
@@ -14632,9 +14623,9 @@
                 tif_lib=`find_lib "libtiff-*.dll"`
                 ;;
             *)
-                tif_lib=`find_lib "libtiff.so.[0-9]"`
+                tif_lib=`find_lib "libtiff[0-9]*.so.*"`
                 if test x$tif_lib = x; then
-                    tif_lib=`find_lib "libtiff.so.[0-9]*"`
+                    tif_lib=`find_lib "libtiff.so.*"`
                 fi
                 ;;
         esac
@@ -15148,15 +15139,9 @@
                 webp_lib=`find_lib "libwebp*.dll"`
                 ;;
             *)
-                webp_lib=`find_lib "libwebp.so.[0-9]"`
-                if test x$webp_lib = x; then
-                    webp_lib=`find_lib "libwebp.so.[0-9]*"`
-                fi
+                webp_lib=`find_lib "libwebp[0-9]*.so.*"`
                 if test x$webp_lib = x; then
-                    webp_lib=`find_lib "libwebp*.so.[0-9]"`
-                fi
-                if test x$webp_lib = x; then
-                    webp_lib=`find_lib "libwebp*.so.[0-9]*"`
+                    webp_lib=`find_lib "libwebp.so.*"`
                 fi
                 ;;
         esac
diff -r 12758bec1240 -r f5f1e8452f74 configure.in
--- a/configure.in	Sat Oct 13 15:55:55 2018 +0300
+++ b/configure.in	Sat Oct 13 17:21:40 2018 +0300
@@ -104,7 +104,7 @@
         host_lib_path="/usr/$base_libdir /usr/local/$base_libdir"
     fi
     for path in $env_lib_path $gcc_bin_path $gcc_lib_path $host_lib_path; do
-        lib=[`ls -- $path/$1 2>/dev/null | sort | sed 's/.*\/\(.*\)/\1/; q'`]
+        lib=[`ls -- $path/$1 2>/dev/null | sed -e '/\.so\..*\./d' -e 's,.*/,,' | sort | tail -1`]
         if test x$lib != x; then
             echo $lib
             return
@@ -176,12 +176,9 @@
                 jpg_lib=[`find_lib "libjpeg*.dll"`]
                 ;;
             *)
-                jpg_lib=[`find_lib "libjpeg.so.[0-9]"`]
+                jpg_lib=[`find_lib "libjpeg[0-9]*.so.*"`]
                 if test x$jpg_lib = x; then
-                    jpg_lib=[`find_lib "libjpeg.so.[0-9][0-9]"`]
-                fi
-                if test x$jpg_lib = x; then
-                    jpg_lib=[`find_lib "libjpeg.so.[0-9]*"`]
+                    jpg_lib=[`find_lib "libjpeg.so.*"`]
                 fi
                 ;;
         esac
@@ -216,15 +213,9 @@
                 png_lib=[`find_lib "libpng*.dll"`]
                 ;;
             *)
-                png_lib=[`find_lib "libpng.so.[0-9]"`]
-                if test x$png_lib = x; then
-                    png_lib=[`find_lib "libpng.so.[0-9]*"`]
-                fi
+                png_lib=[`find_lib "libpng[0-9]*.so.*"`]
                 if test x$png_lib = x; then
-                    png_lib=[`find_lib "libpng*.so.[0-9]"`]
-                fi
-                if test x$png_lib = x; then
-                    png_lib=[`find_lib "libpng*.so.[0-9]*"`]
+                    png_lib=[`find_lib "libpng.so.*"`]
                 fi
                 ;;
         esac
@@ -248,9 +239,9 @@
                 tif_lib=[`find_lib "libtiff-*.dll"`]
                 ;;
             *)
-                tif_lib=[`find_lib "libtiff.so.[0-9]"`]
+                tif_lib=[`find_lib "libtiff[0-9]*.so.*"`]
                 if test x$tif_lib = x; then
-                    tif_lib=[`find_lib "libtiff.so.[0-9]*"`]
+                    tif_lib=[`find_lib "libtiff.so.*"`]
                 fi
                 ;;
         esac
@@ -285,15 +276,9 @@
                 webp_lib=[`find_lib "libwebp*.dll"`]
                 ;;
             *)
-                webp_lib=[`find_lib "libwebp.so.[0-9]"`]
-                if test x$webp_lib = x; then
-                    webp_lib=[`find_lib "libwebp.so.[0-9]*"`]
-                fi
+                webp_lib=[`find_lib "libwebp[0-9]*.so.*"`]
                 if test x$webp_lib = x; then
-                    webp_lib=[`find_lib "libwebp*.so.[0-9]"`]
-                fi
-                if test x$webp_lib = x; then
-                    webp_lib=[`find_lib "libwebp*.so.[0-9]*"`]
+                    webp_lib=[`find_lib "libwebp.so.*"`]
                 fi
                 ;;
         esac
